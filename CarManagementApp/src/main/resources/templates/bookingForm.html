<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Đặt vé chuyến đi</title>
    <th:block th:replace="~{base :: styles}"></th:block>
</head>

<body>
    <div th:replace="~{base :: header}"></div>

    <main class="container-fluid mt-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Đặt vé chuyến đi</h1>
        </div>

        <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${errorMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <div class="card mb-4 shadow">
            <div class="card-header py-3 bg-primary text-white">
                <h6 class="m-0 font-weight-bold">Thông tin chuyến đi</h6>
            </div>
            <div class="card-body">
                <p><strong>Tuyến đường:</strong> <span th:text="${trip.routeId.origin}"></span> - <span th:text="${trip.routeId.destination}"></span></p>
                <p><strong>Tên tuyến:</strong> <span th:text="${trip.routeId.routeName}"></span></p>
                <p><strong>Thời gian khởi hành:</strong> <span th:text="${#temporals.format(trip.departureTime, 'HH:mm dd-MM-yyyy')}"></span></p>
                <p><strong>Thời gian dự kiến đến:</strong> <span th:text="${#temporals.format(trip.arrivalTime, 'HH:mm dd-MM-yyyy')}"></span></p>
                <p><strong>Giá vé:</strong> <span th:text="${#numbers.formatDecimal(trip.fare, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'"></span></p>
                <p><strong>Ghế trống còn lại:</strong> <span th:text="${trip.availableSeats}"></span></p>
                <p><strong>Xe:</strong> <span th:text="${trip.busId.licensePlate}"></span> (<span th:text="${trip.busId.model}"></span>)</p>
                <p><strong>Tài xế:</strong> <span th:text="${trip.driverId.userId.username}"></span></p>
            </div>
        </div>

        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Thông tin đặt chỗ</h6>
            </div>
            <div class="card-body">
                <form th:action="@{/trips/{tripId}/book(tripId=${trip.id})}" method="post" th:object="${booking}">
                    <div class="mb-3">
                        <label for="numberOfSeats" class="form-label">Số lượng ghế:</label>
                        <input type="number" id="numberOfSeats" name="numberOfSeats" class="form-control" min="1" th:max="${trip.availableSeats}" required/>
                    </div>
                    <div class="mb-3">
                        <label for="seatNumbers" class="form-label">Số ghế (ví dụ: A1, A2; tùy chọn):</label>
                        <input type="text" id="seatNumbers" name="seatNumbers" class="form-control" placeholder="A1, A2"/>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-success me-2">Xác nhận đặt vé</button>
                        <a th:href="@{/}" class="btn btn-secondary">Quay lại trang chính</a>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <div th:replace="~{base :: footer}"></div>
    <script th:src="@{/js/main.js}"></script>
</body>

</html>